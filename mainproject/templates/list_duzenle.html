{% extends "layout_admin.html" %}
{% load static %}

{% block title %}Yazı Güncelle | {{ yazi.title }}{% endblock %}

{% block content %}
    <!-- Main Content -->
    <div class="main-panel">
        <div class="section-box">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h3>✏️ Yazı Güncelle</h3>
                <a href="{% url 'admin-yazi-listesi' %}" class="btn btn-outline-secondary">
                    <i class="fas fa-arrow-left me-2"></i> Listeye Dön
                </a>
            </div>

            <form method="post" enctype="multipart/form-data" class="article-edit-form">
                {% csrf_token %}
                
                <div class="mb-4">
                    <label for="baslik" class="form-label">Başlık</label>
                    <input type="text" class="form-control" name="baslik" value="{{ yazi.title }}" required>
                </div>

                <div class="mb-4">
                    <label for="content" class="form-label">İçerik</label>
                    <textarea class="form-control" name="description" id="editor" rows="8">{{ yazi.description }}</textarea>
                </div>

                <div class="row g-3 mb-4">
                    <!-- Resim Yükleme Alanı -->
                    <div class="col-md-6">
                        <label for="image" class="form-label">Resim</label>
                        <input type="file" class="form-control" name="image" accept="image/*">
                        {% if yazi.imageUrl %}
                        <div class="mt-3">
                            <small class="text-muted">Mevcut Resim:</small>
                            <div class="border p-2 mt-1 text-center">
                                <img src="{{ yazi.imageUrl.url }}" alt="Current image" class="img-fluid" style="max-height: 200px;">
                            </div>
                        </div>
                        {% endif %}
                    </div>

                    <!-- Kategori ve Aktiflik -->
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="aktif" class="form-label">Aktif mi?</label>
                            <select name="aktif" class="form-select">
                                <option value="True" {% if yazi.isActive %}selected{% endif %}>Evet</option>
                                <option value="False" {% if not yazi.isActive %}selected{% endif %}>Hayır</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="d-flex gap-3">
                    <button type="submit" class="btn btn-success px-4 py-2 flex-grow-1">
                        <i class="fas fa-save me-2"></i> Kaydet
                    </button>
                    <a href="{% url 'admin-yazi-listesi' %}" class="btn btn-secondary px-4 py-2 flex-grow-1">
                        İptal
                    </a>
                </div>
            </form>
        </div>
    </div>

    <script src="https://cdn.ckeditor.com/4.22.1/standard/ckeditor.js"></script>
    <script>
        CKEDITOR.replace('editor', {
            width: '100%',
            height: '300px',
            toolbar: [
                { name: 'basicstyles', items: ['Bold', 'Italic', 'Underline', 'Strike'] },
                { name: 'paragraph', items: ['NumberedList', 'BulletedList', '-', 'Blockquote'] },
                { name: 'links', items: ['Link', 'Unlink'] },
                { name: 'insert', items: ['Image', 'Table'] },
                { name: 'document', items: ['Source'] }
            ]
        });
    </script>

    <style>
        .article-edit-form {
            max-width: 1000px;
            margin: 0 auto;
        }
        
        @media (max-width: 768px) {
            .section-box h3 {
                font-size: 1.5rem;
            }
            
            .article-edit-form .form-label {
                font-size: 0.95rem;
            }
            
            .article-edit-form .form-control,
            .article-edit-form .form-select {
                font-size: 0.95rem;
            }
            
            .article-edit-form .btn {
                font-size: 0.95rem;
            }
        }
        
        @media (max-width: 576px) {
            .article-edit-form .d-flex {
                flex-direction: column;
            }
            
            .article-edit-form .btn {
                width: 100%;
                margin-bottom: 0.5rem;
            }
            
            .article-edit-form textarea {
                min-height: 250px;
            }
        }
    </style>
{% endblock %}
